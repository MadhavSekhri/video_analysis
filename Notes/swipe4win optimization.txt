swipe4win optimization

Create a simple code api in php where take in headers take all these(in string)
newOperator 
countryCode
timeZone
Packs-Daily
Packs-Weekly
Packs-Monthly
Packs-Topup
setSize
unitsServed-Remaining
freeSet
topupLimit
freeBundlesLimit
 

Step-1. locally connect mongodb with database named "swipe2winlive" and check if these collections are there, if any of these collections already exists then make sure they are empty if not remove documents in that putting a message in response "I removed {CollectionName} documents to make it empty"(please note remove documents here if needed must be only from below collections only not other) then skip that else create these empty collections : answer_{newOperator}, event_{newOperator}, user_{newOperator}, sessions_{newOperator} ,operators_{newOperator}, packs_{newOperator}
If all created successfully, put a message in response "All requirement empty collections created successfully" and then go to step-2 Else: "Error in Step1 Creating Empty Collections" and return api with status failure	

step-2: Now go to collection named operator_{newOperator} 
now start checking headers:
if setSize is there then convert it to float say If i got "10" I will use it as 10.0 for "5" I will use 5.0, if no setSize given in headers set it to 5.0 also append in api response message" "No setSize Found! Don't worry I am setting it to 5 as of now."
then check timeZone or country code if not Present "return api immediately with status failure and message appended in response "Oops!Failed to find Timezone or country code Please try again by adding them"
then check unitsServed-Remaining is there if it is not in headers set it to "true" by appending message in response "No unitsServed-Remaining Found! Don't worry I am setting it to true as of now(means user will get remaining questions)"
If freeSet is not found in headers set it to "false" by appending message in response "No freeSet Found! Don't worry I am setting it to false(means user won't be getting freeSet)"
If freeBundlesLimit is not found set it to 0 by appending message in response "No freeBundlesLimit Found! Don't worry I am setting it to 0(means user won't be getting any freeSet)"
If topupLimit is not found set it to 1000 appending message in response "No topupLimit Found! Don't worry I am setting it to 1000(means user will get infine topups in a day)"

add document like this where everything in {} means its dynamic

{
    "_id" : "{newOperator}",
    "operatorName" : "{newOperator}",
    "operatorId" : "{newOperator}",
    "countryCode" : "{countryCode}",
    "timeZone" : "{timeZone}",
    "reserveList" : [
        {
            "setType" : "NUMSET",
            "isReserve" : true,
            "totalQuestionsInSet" : 10.0,//this is also dynamic
            "unitsServed" : "REMAINING" //if unitsServed-Remaining is true or "true"(handle lower upper capital all types of cases) if unitsServed-Remaining is "false" then put "NONE" instead of "REMAINING"
        }
    ],
    "topupLimitPerDay" : NumberInt(0),
    "freeBundlesLimitPerDay" : NumberInt(0)
}
please note if freeSet is true or True
add this document in reserveList Array
{
            "setType" : "FREESET",
            "isReserve" : true,
            "totalQuestionsInSet" : 5.0,//this is also dynamic
            "unitsServed" : "NONE",/if unitsServed-Remaining is true or "true"(handle lower upper capital all types of cases) if unitsServed-Remaining is "false" then put "NONE" instead of "REMAINING"

        }

If everything went well, append a message "Operators collection work done successfully!"


okay cool, please make sure the setSize you taking in float only 
Step3 go to collection named packs_{newOperator}:
check these one by one 
Packs-Daily
Packs-Weekly
Packs-Monthly
Packs-Topup

if Packs-Daily true then append this document {
    "_id" : "dailypack",
    "packText" : [
           ]
}


if Packs-Weekly is true append this document		
{
    "_id" : "weeklypack",
    "packText" : [
]
}
if Packs-Monthly is true append this document
{
    "_id" : "monthlypack",
    "packText" : [
    ]
}



if Packs-Topup is true append this document
{
    "_id" : "dailytopup",
    "packText" : [
    ]
}

At the end club one message saying these these documents added in Packs collection and return with success and everything is done now else if we face any issue then throw a failure with message "Error while adding documents in Packs colletion" also make sure operatorId is dynamic from headers.


please use mongo manager like connect this way
<?php

function checkMongoDBConnection() {
    try {
        // Replace with your MongoDB connection string
        $manager = new MongoDB\Driver\Manager("mongodb://localhost:27017");

        // Ping the server to ensure it's up and running
        $command = new MongoDB\Driver\Command(['ping' => 1]);
        $manager->executeCommand('admin', $command);

        echo "34.208.128.23 | Successfully connected to MongoDB...";
    d} catch (MongoDB\Driver\Exception\Exception $e) {
        echo "34.208.128.23| Oops!Failed to connect to MongoDB. Please look into it. ", $e->getMessage();
    }
}

// Call the function to check the connection
checkMongoDBConnection();

